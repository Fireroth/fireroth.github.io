@set menuPath=%cd%
@set dataPath=%cd%\Command_Miner_Data
@set modsPath=%cd%\Command_Miner_Data\Mods
@set accountsPath=%cd%\Command_Miner_Data\Accounts
@if [%1]==[] (echo No file attached.) else call %1
@title Starting up...
@set key=0
@color 07
@setlocal EnableDelayedExpansion
@echo off
call:%~1 >nul 2>nul
echo|set /p= [0;94m[PreStartup][0;0m 
chcp 65001
echo|set /p= [0;94m[PreStartup][0;0m Checking permissions...
net session >nul 2>&1
if %errorlevel% == 0 (
  goto errorAdmin
)
echo [0;32mPASSED[0;0m
echo|set /p=  [0;94m[PreStartup][0;0m Checking internet connection...
ping www.google.com -n 1 -w 1000>nul
if errorlevel 1 (set internet=none & echo [0;31mFAILED[0;0m) else (set internet=connected & echo [0;32mPASSED[0;0m)
echo.

if not exist Command_Miner_Data (cls
								title Welcome
								echo Welcome to [0;96mCommand Miner[0;0m
								echo.
								echo.
								echo Command Miner is a text based game written only in Batch originally inspired by Discord bot Idle Miner
								echo [0;91mDon't forget to save your progress as it is not saved automatically^^![0;0m
								echo.
								echo [0;94m[NOTE][0;0m A folder will be created to save all user data and other important files at the following location
								echo [0;94m[NOTE][0;0m %cd%
								echo.
								echo [0;32mPress any key to start mining...[0;0m
								pause>nul)
:reload
cd %menuPath%
echo [0;94mStarting up...[0;0m
title Starting up...
if not exist Command_Miner_Data md Command_Miner_Data & echo [0;94m[Startup][0;0m Creating Command_Miner_Data folder
cd Command_Miner_Data & echo [0;94m[Startup][0;0m Entering Command_Miner_Data folder
if errorlevel=1 echo [0;94m[Startup][0;0m Failed to create folder! & pause >nul & exit

if not exist Config md Config & echo [0;94m[Startup][0;0m Creating Config folder
cd Config & echo [0;94m[Startup][0;0m Entering Config folder
if not exist unlockedScreenSize.cmd echo set unlockedScreenSize=false>unlockedScreenSize.cmd& echo [0;94m[Startup][0;0m Creating unlockedScreenSize.cmd file
call unlockedScreenSize.cmd & echo [0;94m[Startup][0;0m Calling unlockedScreenSize.cmd file
if not %unlockedScreenSize% == true (mode con cols=120 lines=30) else echo.>nul
cd..

if not exist UpdateFiles md UpdateFiles & echo [0;94m[Startup][0;0m Creating UpdateFiles folder
cd UpdateFiles & echo [0;94m[Startup][0;0m Entering UpdateFiles folder
if errorlevel=1 echo [0;94m[Startup][0;0m Failed to create folder! & pause >nul & exit
if not exist Update.bat echo cd.. ^& cd.. ^& curl -B https://fireroth.github.io/download/data/CommandMiner/latest^>CommandMiner.bat ^& cd Command_Miner_Data ^& cd UpdateFiles ^& mshta.exe vbscript:Execute^("msgbox ""Successfully installed latest version""& VbCrLf & VbCrLf &""Click 'Ok' to exit"",0+64,""Updated Command Miner"":close"^) ^& exit>Update.bat & echo [0;94m[Startup][0;0m Creating Update.bat file
cd..

cd Config & echo [0;94m[Startup][0;0m Entering Config folder
if not exist CFT.cmd echo set /a consoleFreezeTime=^0>CFT.cmd & echo [0;94m[Startup][0;0m Creating CFT.cmd file
if not exist cheatPerm.cmd echo set cheatPermission=false>cheatPerm.cmd& echo [0;94m[Startup][0;0m Creating cheatPerm.cmd file
if not exist bootType.cmd echo set boot=normal>bootType.cmd& echo [0;94m[Startup][0;0m Creating bootType.cmd file
if not exist accounts.cmd echo set accEnabled=false>accounts.cmd& echo [0;94m[Startup][0;0m Creating accounts.cmd file
call bootType.cmd & echo [0;94m[Startup][0;0m Calling bootType.cmd file
call accounts.cmd & echo [0;94m[Startup][0;0m Calling accounts.cmd file
if not defined boot set boot=normal
cd..

if not exist Save md Save & echo [0;94m[Startup][0;0m Creating Save folder
cd Save & echo [0;94m[Startup][0;0m Entering Save folder
if not exist main.save echo.>main.save& echo [0;94m[Startup][0;0m Creating main.save file
cd..

if not exist Accounts md Accounts & echo [0;94m[Startup][0;0m Creating Accounts folder 
set account=Main&  echo [0;94m[Startup][0;0m Setting account to Main
cd Accounts &  echo [0;94m[Startup][0;0m Entering Accounts folder
if %accEnabled%==true (
					echo. 
					echo [0;0m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
					echo [0;93mList of all accounts:[0;96m
					dir /a:d /b
					echo [0;0m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
					echo. 
					title Accounts...
					set /p account=[0;93mEnter account name ^(blank for Main^):[0;0m
					)
					
cmd /v:on /c echo(^^!account^^! | findstr /r "^[^^^\\/?%%*:|<>\.\"]*$^" > nul
if not %errorlevel% equ 0 echo [0;91mBanned character has been used & echo List of banned characters:[0;0m ^\^/^|^<^>^%^.^?^*^: &pause&goto reload
if not exist %account% md %account%
cd %account%
if errorlevel=1 goto ErrorFile
if not exist Mods (md Mods)
cd..
cd..

if not exist Mods md Mods & echo [0;94m[Startup][0;0m Creating Mods folder
echo [0;94m[Startup][0;0m Calling Startup.bat from Mods

rem  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
rem Mod loader (startup.bat)
cd %modsPath%
title Modding...
for /D %%i in (.\*) do (
cd "%%i"
if exist Startup.bat call Startup.bat
if errorlevel=1 goto ErrorMod
cd..
)

cd %accountsPath%\%account%\Mods
for /D %%i in (.\*) do (
cd "%%i"
if exist Startup.bat call Startup.bat
if errorlevel=1 goto ErrorMod
cd..
)
rem  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

cd %dataPath%
title Starting up...
echo [0;94m[Startup][0;0m Setting up important stuff...
set cheats=false
set command=invalid
set cheatPermission=false
set ver=1.0.8
set command2=1
set command3=1
set /a minimumMined=0
set maxBPSize=
set maxMined=
set multi=															
set pickaxe=Wooden
set backpack=Wooden
set money=0
set ore=0
set token=0
set oreName=Coal
set /a commonCrate=0
set /a uncommonCrate=0
set /a rareCrate=0
set /a epicCrate=0
set /a legendaryCrate=0
set dimension=Overworld
set /a rebirthReward=0
set /a autosell=0
set /a rebirthCount=0
set /a starterPack=0

cd save & echo [0;94m[Startup][0;0m Entering Save folder
echo [0;94m[Startup][0;0m Calling save file...
< %account%.save (
set /p backpack=
set /p pickaxe=
set /p money=
set /p ore=
set /p token=
set /p oreName=
set /p commonCrate=
set /p uncommonCrate=
set /p rareCrate=
set /p epicCrate=
set /p legendaryCrate=
set /p minimumMined=
set /p dimension=
set /p rebirthReward=
set /p autosell=
set /p rebirthCount=
set /p starterPack=
)
cd..
cd Config & echo [0;94m[Startup][0;0m Entering Config folder
echo [0;94m[Startup][0;0m Calling config files...
call cheatPerm.cmd
if errorlevel=1 echo [0;94m[Startup][0;0m Failed to find cheatPerm.cmd
call CFT.cmd
if errorlevel=1 echo [0;94m[Startup][0;0m Failed to find consoleFreezeTime.cmd
cd..
timeout %consoleFreezeTime%>nul
cls


:main
if %internet%==none (echo 				[1;36m---------------------------------------------[0;0m 
					 echo.
					 echo                  				Command Miner
					 echo                  				  [0;33m[[0;31mOFFLINE[0;33m][0;0m
					 echo.
					 echo 				[1;36m---------------------------------------------[0;0m 
					)else curl https://fireroth.github.io/download/data/CommandMiner/logo
					 
echo [0;91mUse [0;93mhelp[0;0m[0;91m for list of all available commands[0;0m
echo [0;91mUse [0;93msave[0;0m[0;91m to save your progress[0;0m
if %internet%==none echo [0;91mSlow or no internet connection[0;0m
if %accEnabled% == true echo [0;94mLogged as %account%[0;0m

rem  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
rem Mod loader (splash.txt)
cd %modsPath%
title Modding...
for /D %%i in (.\*) do (
cd "%%i"
if exist splash.txt type splash.txt
if errorlevel=1 goto ErrorMod
cd..
)

cd %accountsPath%\%account%\Mods
for /D %%i in (.\*) do (
cd "%%i"
if exist splash.txt type splash.txt
if errorlevel=1 goto ErrorMod
cd..
)
rem  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:cmdselect
set command2=1
rem  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
rem Mod loader (InitializationBefore.bat)
cd %modsPath%
for /D %%i in (.\*) do (
cd "%%i"
if exist InitializationBefore.bat call InitializationBefore.bat
if errorlevel=1 goto ErrorMod
cd..
)

cd %accountsPath%\%account%\Mods
for /D %%i in (.\*) do (
cd "%%i"
if exist InitializationBefore.bat call InitializationBefore.bat
if errorlevel=1 goto ErrorMod
cd..
)
rem  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

cd %dataPath%
set title=Command Miner       Money: %money%^$      Tokens: %token%      Pickaxe: %pickaxe%      Backpack: %backpack%      Ore: %orename%
if %autosell%==1 (if %ore% == %maxBPSize% goto sell) else echo.>nul
if %money% GTR 2000000000 set money=2000000000

set tier1=300
set tier2=1500
set tier3=4500
set tier4=10000
set tier5=25000
set tier6=75000
set tier7=140000
set tier8=300000
set tier9=900000
set tier10=2500000

set maxPickaxe=Obsidian
set maxBackpack=Obsidian
set maxOre=Netherite

if %oreName% == Coal set /a multi=1
if %oreName% == Iron set /a multi=1
if %oreName% == Copper set /a multi=2
if %oreName% == Lapis set /a multi=2
if %oreName% == Quartz set /a multi=3
if %oreName% == Gold set /a multi=3
if %oreName% == Redstone set /a multi=4
if %oreName% == Diamond set /a multi=4
if %oreName% == Emerald set /a multi=5
if %oreName% == Netherite set /a multi=6
if %oreName% == Negative set /a multi=2147483647
if %oreName% == OverLimit set /a multi=2147483648

if %orename% == Emerald set /a upOrePrice=9
if %orename% == Diamond set /a upOrePrice=8
if %oreName% == Redstone set /a upOrePrice=7
if %orename% == Gold set /a upOrePrice=6
if %orename% == Quartz set /a upOrePrice=5
if %orename% == Lapis set /a upOrePrice=4
if %orename% == Copper set /a upOrePrice=3
if %orename% == Iron set /a upOrePrice=2
if %orename% == Coal set /a upOrePrice=1

if %orename% == Emerald set nextore=Netherite
if %orename% == Diamond set nextore=Emerald
if %oreName% == Redstone set nextore=Diamond
if %orename% == Gold set nextore=Redstone
if %orename% == Quartz set nextore=Gold
if %orename% == Lapis set nextore=Quartz
if %orename% == Copper set nextore=Lapis
if %orename% == Iron set nextore=Copper
if %orename% == Coal set nextore=Iron

if %pickaxe% == Wooden set maxMined=10
if %pickaxe% == Stone set maxMined=20
if %pickaxe% == Copper set maxMined=40
if %pickaxe% == Iron set maxMined=60
if %pickaxe% == Quartz set maxMined=90
if %pickaxe% == Golden set maxMined=120
if %pickaxe% == Redstone set maxMined=180
if %pickaxe% == Diamond set maxMined=250
if %pickaxe% == Emerald set maxMined=450
if %pickaxe% == Netherite set maxMined=800
if %pickaxe% == Obsidian set maxMined=1500

if %pickaxe% == Netherite set nextpickaxe=Obsidian
if %pickaxe% == Emerald set nextpickaxe=Netherite
if %pickaxe% == Diamond set nextpickaxe=Emerald
if %pickaxe% == Redstone set nextpickaxe=Diamond
if %pickaxe% == Golden set nextpickaxe=Redstone
if %pickaxe% == Quartz set nextpickaxe=Golden
if %pickaxe% == Iron set nextpickaxe=Quartz
if %pickaxe% == Copper set nextpickaxe=Iron
if %pickaxe% == Stone set nextpickaxe=Copper
if %pickaxe% == Wooden set nextpickaxe=Stone

if %backpack% == Wooden set maxBPSize=25
if %backpack% == Stone set maxBPSize=75
if %backpack% == Copper set maxBPSize=150
if %backpack% == Iron set maxBPSize=250
if %backpack% == Quartz set maxBPSize=500
if %backpack% == Golden set maxBPSize=700
if %backpack% == Redstone set maxBPSize=1200
if %backpack% == Diamond set maxBPSize=3000
if %backpack% == Emerald set maxBPSize=6000
if %backpack% == Netherite set maxBPSize=12500
if %backpack% == Obsidian set maxBPSize=25000
if %backpack% == Infinite set maxBPSize=nul

if %backpack% == Netherite set nextbp=Obsidian
if %backpack% == Emerald set nextbp=Netherite
if %backpack% == Diamond set nextbp=Emerald
if %backpack% == Redstone set nextbp=Diamond
if %backpack% == Golden set nextbp=Redstone
if %backpack% == Quartz set nextbp=Golden
if %backpack% == Iron set nextbp=Quartz
if %backpack% == Copper set nextbp=Iron
if %backpack% == Stone set nextbp=Copper
if %backpack% == Wooden set nextbp=Stone

set /a upMinMinedPrice=1
if %minimumMined% == 15 set /a upMinMinedPrice=0

if %minimumMined% == 14 set nextMinMined=15
if %minimumMined% == 13 set nextMinMined=14
if %minimumMined% == 12 set nextMinMined=13
if %minimumMined% == 11 set nextMinMined=12
if %minimumMined% == 10 set nextMinMined=11
if %minimumMined% == 9 set nextMinMined=10
if %minimumMined% == 8 set nextMinMined=9
if %minimumMined% == 7 set nextMinMined=8
if %minimumMined% == 6 set nextMinMined=7
if %minimumMined% == 5 set nextMinMined=6
if %minimumMined% == 4 set nextMinMined=5
if %minimumMined% == 3 set nextMinMined=4
if %minimumMined% == 2 set nextMinMined=3
if %minimumMined% == 1 set nextMinMined=2
if %minimumMined% == 0 set nextMinMined=1

if %rebirthReward% == 0 set /a upRebirthRewardPrice=5
if %rebirthReward% == 1 set /a upRebirthRewardPrice=0
if %rebirthReward% == 0 set nextRebirthReward=1
if %rebirthReward% == 0 set /a tokenPlus=1
if %rebirthReward% == 1 set /a tokenPlus=2

if %autosell% == 0 set /a upAutosellPrice=10
if %autosell% == 1 set /a upAutosellPrice=0

if %starterPack% == 0 set /a upStarterPackPrice=3
if %starterPack% == 1 set /a upStarterPackPrice=10
if %starterPack% == 2 set /a upStarterPackPrice=0
if %starterPack% == 0 set nextStarterPack=1
if %starterPack% == 1 set nextStarterPack=2


rem  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
rem Mod loader (InitializationAfter.bat)
cd %modsPath%
for /D %%i in (.\*) do (
cd "%%i"
if exist InitializationAfter.bat call InitializationAfter.bat
if errorlevel=1 goto ErrorMod
cd..
)

cd %accountsPath%\%account%\Mods
for /D %%i in (.\*) do (
cd "%%i"
if exist InitializationAfter.bat call InitializationAfter.bat
if errorlevel=1 goto ErrorMod
cd..
)
rem  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

if not defined maxBPSize goto ErrorVariables
if not defined maxMined goto ErrorVariables
if not defined multi goto ErrorVariables

:input
cd %dataPath%
title %title%

echo.
set /p "command=Enter command:"
set count=0
for %%a in (%command%) do (
  set /a count+=1
  set command!count!=%%a
)


rem  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
rem Mod loader (commands.bat)
cd %modsPath%
for /D %%i in (.\*) do (
cd "%%i"
if exist Commands.bat call Commands.bat
if errorlevel=1 goto ErrorMod
cd..
)

cd %accountsPath%\%account%\Mods
for /D %%i in (.\*) do (
cd "%%i"
if exist Commands.bat call Commands.bat
if errorlevel=1 goto ErrorMod
cd..
)
rem  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

cd %dataPath%

if /i "%command%" == "mine" goto mine
if /i "%command%" == "sell" goto sell
if /i "%command%" == "invalid" echo [0;31mPlease enter valid command![0;0m & goto cmdselect
if /i "%command%" == "stats" goto stats
if /i "%command%" == "clear" cls & goto cmdselect
if /i "%command%" == "shop" goto shop
if /i "%command%" == "reload" cls & cd.. & goto reload
if /i "%command%" == "help" goto help
if /i "%command%" == "save" goto saveProgress
if /i "%command%" == "balance" goto balance
if /i "%command%" == "rebirth" goto rebirth
if /i "%command%" == "cheat" echo Invalid syntax, use [0;93mcheat_CHEATNAME[0;0m & goto cmdselect
if /i "%command%" == "cheat_" echo Invalid syntax, use [0;93mcheat_CHEATNAME[0;0m & goto cmdselect
if /i "%command%" == "reset" goto resetConfirm
if /i "%command%" == "upgrade ore" goto upgradeore
if /i "%command%" == "upgrade backpack" goto upgradebp
if /i "%command%" == "upgrade pickaxe" goto upgradePick
if /i "%command%" == "ore info" goto oreInfo
if /i "%command1%" == "open" echo>nul& if /i "%command2%" == "common" goto openCrateCommon
if /i "%command1%" == "open" echo>nul& if /i "%command2%" == "uncommon" goto openCrateUncommon
if /i "%command1%" == "open" echo>nul& if /i "%command2%" == "rare" goto openCrateRare
if /i "%command1%" == "open" echo>nul& if /i "%command2%" == "epic" goto openCrateEpic
if /i "%command1%" == "open" echo>nul& if /i "%command2%" == "legendary" goto openCrateLegendary
if /i "%command1%" == "open" echo>nul& if /i "%command2%" == "all" goto openCrateAll
if /i "%command%" == "crates" goto allCrates
if /i "%command%" == "update" goto Update
if /i "%command%" == "version" goto version
if /i "%command%" == "tokenshop" goto tokenShop
if /i "%command%" == "tokenshop2" goto tokenShop2
if /i "%command1%" == "token" echo>nul& if /i "%command2%" == "shop" goto tokenshop
if /i "%command1%" == "token" echo>nul& if /i "%command2%" == "shop2" goto tokenshop2
if /i "%command%" == "buy1" goto upgradeMinMined
if /i "%command%" == "open" echo Invalid syntax, use [0;93mopen CRATE_NAME[0;0m & goto cmdselect
if /i "%command%" == "set" echo Invalid syntax, use [0;93mset SETTING_NAME[0;0m & goto cmdselect
if /i "%command%" == "exit" echo Exiting... & endlocal & exit
if /i "%command%" == "set help" goto setHelp
if /i "%command%" == "set /?" goto setHelp
if /i "%command%" == "buy2" goto upgradeRebirthReward
if /i "%command%" == "buy3" goto upgradeAutosell
if /i "%command%" == "buy4" goto upgradeSP
if /i "%command%" == "accounts" goto ACCS
if /i "%command%" == "account" goto ACCS
if /i "%command%" == "mod" goto Mods
if /i "%command%" == "mods" goto Mods
if /i "%command1%" == "mod" echo>nul& if /i "%command2%" == "install" goto ModsCheck
if /i "%command1%" == "mods" echo>nul& if /i "%command2%" == "install" goto ModsCheck
if /i "%command1%" == "mods" echo>nul& if /i "%command2%" == "loaded" cd %dataPath%\Mods & dir /a:d /b & cd %accountsPath%\%account%\Mods & dir /a:d /b & goto cmdselect
if /i "%command%" == "dailyReward" goto claimDailyReward

::if /i "%command1%" == "help" echo>nul& if /i "%command2%" == "%command2%" echo [0;91m[Error][0;31m Cannot find help page [0;31m%command2%[0;0m & goto cmdselect

REM Aliases
if /i "%command%" == "m" goto mine
if /i "%command%" == "s" goto sell
if /i "%command%" == "c" cls & goto cmdselect
if /i "%command%" == "cls" cls & goto cmdselect
if /i "%command%" == "bshop" goto boostshop
if /i "%command%" == "ps" goto shop
if /i "%command%" == "u p" goto upgradePick
if /i "%command%" == "up p" goto upgradePick
if /i "%command%" == "up pick" goto upgradePick
if /i "%command%" == "u pick" goto upgradePick
if /i "%command%" == "rl" cls & cd.. & goto reload
if /i "%command%" == "u b" goto upgradebp
if /i "%command%" == "u pb" goto upgradebp
if /i "%command%" == "u backpack" goto upgradebp
if /i "%command%" == "upgrade pick" goto upgradepick
if /i "%command%" == "upgrade p" goto upgradepick
if /i "%command%" == "u pickaxe" goto upgradepick
if /i "%command%" == "upgrade bp" goto upgradebp
if /i "%command%" == "up b" goto upgradebp
if /i "%command%" == "up bp" goto upgradebp
if /i "%command%" == "bal" goto balance
if /i "%command%" == "u o" goto upgradeore
if /i "%command%" == "u ore" goto upgradeore
if /i "%command%" == "up ore" goto upgradeore
if /i "%command%" == "up o" goto upgradeore
if /i "%command%" == "ore" goto oreInfo
if /i "%command%" == "ores" goto oreInfo
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "c" goto openCrateCommon
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "u" goto openCrateUncommon
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "r" goto openCrateRare
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "e" goto openCrateEpic
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "l" goto openCrateLegendary
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "common" goto openCrateCommon
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "uncommon" goto openCrateUncommon
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "rare" goto openCrateRare
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "epic" goto openCrateEpic
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "legendary" goto openCrateLegendary
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "a" goto openCrateAll
if /i "%command1%" == "o" echo>nul& if /i "%command2%" == "all" goto openCrateAll
if /i "%command%" == "ver" goto version
if /i "%command%" == "tshop" goto tokenShop
if /i "%command%" == "tshop2" goto tokenShop2
if /i "%command%" == "ts" goto tokenShop
if /i "%command%" == "ts2" goto tokenShop2
if /i "%command%" == "acc" goto ACCS
if /i "%command%" == "accs" goto ACCS
if /i "%command%" == "o" echo Invalid syntax, use [0;93mo CRATE_NAME[0;0m & goto cmdselect
if /i "%command%" ==  "restart" cd.. & start CommandMiner.bat & exit
if /i "%command%" == "dReward" goto claimDailyReward
if /i "%command%" == "dR" goto claimDailyReward
if /i "%command%" == "claim" goto claimDailyReward

REM cheats
if /i "%command%" == "cheat_freeDreward" if not %cheatPermission%==true (goto noPerms) else set cheats=true & set command=invalid & echo Cheat activated & echo [0;92mSuccesfully claimed daily reward, come back tomorrow for more![0;0m&set /a uncommonCrate=%uncommonCrate% +1 &echo You got 1 [0;92mUncommon[0;0m crate&set /a rareCrate=%rareCrate% +1 &echo You got 1 [0;94mRare[0;0m crate & goto cmdselect
if /i "%command%" == "cheat_infiniteInv" if not %cheatPermission%==true (goto noPerms) else set backpack=Infinite & set cheats=true & set command=invalid & echo Cheat activated & goto cmdselect
if /i "%command%" == "cheat_iAmBroke" if not %cheatPermission%==true (goto noPerms) else set money=-5000 & set cheats=true & set command=invalid & echo Cheat activated & goto cmdselect
if /i "%command%" == "cheat_iWantMoney" if not %cheatPermission%==true (goto noPerms) else set /a money=%money%+25000 & set cheats=true & set command=invalid & echo Cheat activated & goto cmdselect
if /i "%command%" == "cheat_oreMiner" if not %cheatPermission%==true (goto noPerms) else set pickaxe=Obsidian & set cheats=true & set command=invalid & echo Cheat activated & goto cmdselect
if /i "%command%" == "cheat_betterInventory" if not %cheatPermission%==true (goto noPerms) else set backpack=Obsidian & set cheats=true & set command=invalid & echo Cheat activated & goto cmdselect
if /i "%command%" == "cheat_bigTokens" if not %cheatPermission%==true (goto noPerms) else set /a token=%token%+5 & set cheats=true & set command=invalid & echo Cheat activated & goto cmdselect
if /i "%command%" == "cheat_bestOreName" if not %cheatPermission%==true (goto noPerms) else set oreName=Netherite & set cheats=true & set command=invalid & echo Cheat activated & goto cmdselect
if /i "%command%" == "cheat_giveMeBigBoxes" if not %cheatPermission%==true (goto noPerms) else set /a commonCrate=%commonCrate%+5 & set /a uncommonCrate=%uncommonCrate%+5 & set /a rareCrate=%rareCrate%+5 & set /a epicCrate=%epicCrate%+5 & set /a legendaryCrate=%legendaryCrate%+5 & set cheats=true & set command=invalid & echo Cheat activated & goto cmdselect

REM settings
if /i "%command1%" == "set" echo>nul& if "%command2%" == "cheats" goto setCheats
if /i "%command1%" == "set" echo>nul& if "%command2%" == "money" if not %cheatPermission%==true (goto noPerms) else set /a money=%command3%& if errorlevel=1 (goto Error0) else set cheats=true & echo money was set to %command3% & goto cmdselect
if /i "%command1%" == "set" echo>nul& if "%command2%" == "token" if not %cheatPermission%==true (goto noPerms) else set /a token=%command3%& if errorlevel=1 (goto Error0) else set cheats=true & echo token was set to %command3% & goto cmdselect
if /i "%command1%" == "set" echo>nul& if "%command2%" == "pickaxe" if not %cheatPermission%==true (goto noPerms) else set pickaxe=%command3%& if errorlevel=1 (goto Error0) else set cheats=true & echo pickaxe was set to %command3% & goto cmdselect
if /i "%command1%" == "set" echo>nul& if "%command2%" == "backpack" if not %cheatPermission%==true (goto noPerms) else set backpack=%command3%& if errorlevel=1 (goto Error0) else set cheats=true & echo backpack was set to %command3% & goto cmdselect
if /i "%command1%" == "set" echo>nul& if "%command2%" == "ore" if not %cheatPermission%==true (goto noPerms) else set oreName=%command3%& if errorlevel=1 (goto Error0) else set cheats=true & echo oreName was set to %command3% & goto cmdselect
if /i "%command1%" == "set" echo>nul& if "%command2%" == "consoleFreezeTime" goto setCFT
if /i "%command1%" == "set" echo>nul& if "%command2%" == "cft" goto setCFT
if /i "%command1%" == "set" echo>nul& if "%command2%" == "accounts" goto setACC
if /i "%command1%" == "set" echo>nul& if "%command2%" == "unlockedScreenSize" goto setUnlockedScreenSize
if /i "%command1%" == "set" echo>nul& if defined command2 echo [0;91m[Error][0;31m Unknown setting[0;0m& goto cmdselect

if /i "%command%" == "valid" goto cmdselect
echo [0;91m[Error][0;31m This command does not exist[0;0m
goto cmdselect


:setCheats
set cheatPermission=%command3%
echo cheatPermission was set to %command3%
cd Config & echo set cheatPermission=%command3%>cheatPerm.cmd & cd..
goto cmdselect


:setCFT
set consoleFreezeTime=%command3%
echo consoleFreezeTime was set to %command3% 
cd Config & echo set consoleFreezeTime=%command3% > CFT.cmd & cd.. 
goto cmdselect


:setACC
set accEnabled=%command3%
echo accEnabled was set to %command3% 
cd Config & echo set accEnabled=%command3%>accounts.cmd& cd..
if %key%==ACCService echo Done...&timeout 1 >nul&goto ACCS
goto cmdselect


:setUnlockedScreenSize
set unlockedScreenSize=%command3%
echo unlockedScreenSize was set to %command3% 
cd Config & echo set unlockedScreenSize=%command3%>unlockedScreenSize.cmd& cd..
goto cmdselect


:setHelp
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
echo set cheats [[0;32mtrue[0;0m/[0;31mfalse[0;0m] [0;35m(c=%cheatPermission%) (d=false)[0;0m
echo set accounts [[0;32mtrue[0;0m/[0;31mfalse[0;0m] [0;35m(c=%accEnabled%) (d=false)[0;0m
echo set consoleFreezeTime [[0;94mvalue[0;0m] [0;35m(c=%consoleFreezeTime%) (d=0)[0;0m
echo set unlockedScreenSize [[0;32mtrue[0;0m/[0;31mfalse[0;0m] [0;35m(c=%unlockedScreenSize%) (d=false)[0;0m
echo [[0;35mc=current [0;0m^| [0;35md=default[0;0m]
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m
if %cheatPermission% == true (
echo.
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
echo set money [[0;94mvalue[0;0m]
echo set token [[0;94mvalue[0;0m]
echo set ore [[0;94mCoal[0;0m/[0;94mIron[0;0m/[0;94mLapis[0;0m/[0;94mQuartz[0;0m/[0;94mGold[0;0m/[0;94mResdtone[0;0m/[0;94mDiamond[0;0m/[0;94mNetherite[0;0m/[0;31mNegative[0;0m/[0;31mOverLimit[0;0m]
echo set pickaxe [[0;94mWooden[0;0m/[0;94mStone[0;0m/[0;94mCopper[0;0m/[0;94mIron[0;0m/[0;94mQuartz[0;0m/[0;94mGolden[0;0m/[0;94mResdtone[0;0m/[0;94mDiamond[0;0m/[0;94mEmerald[0;0m/[0;94mNetherite[0;0m/[0;94mObsidian[0;0m]
echo set backpack [[0;94mWooden[0;0m/[0;94mStone[0;0m/[0;94mCopper[0;0m/[0;94mIron[0;0m/[0;94mQuartz[0;0m/[0;94mGolden[0;0m/[0;94mResdtone[0;0m/[0;94mDiamond[0;0m/[0;94mEmerald[0;0m/[0;94mNetherite[0;0m/[0;94mObsidian[0;0m/[0;31mInfinite[0;0m]
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m )

goto cmdselect


:sell
if %ore%==0 goto noOre
set /a transfer=%ore%*%multi%
set /a money=%money%+(%ore%*%multi%)
echo [0;32m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
echo You sold %ore% %orename% for %transfer%^$
echo [0;32m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
set /a ore=0
set command=invalid
goto cmdselect


:mine
if %ore% == %maxBPSize% goto maxBackPack 
set /a crateChance=%random% %% 75
if %crateChance% GTR 73 set /a commonCrate=%commonCrate%+1 & echo [0;33mYou mined 1 Common crate![0;0m

set /a crateChance1=%random% %% 150
if %crateChance1% GTR 148 set /a uncommonCrate=%uncommonCrate%+1 & echo [0;33mYou mined 1 Uncommon crate![0;0m

set /a crateChance2=%random% %% 300
if %crateChance2% GTR 298 set /a rareCrate=%rareCrate%+1 & echo [0;33mYou mined 1 Rare crate![0;0m

set /a crateChance3=%random% %% 500
if %crateChance3% GTR 499 set /a epicCrate=%epicCrate%+1 & echo [0;33mYou mined 1 Epic crate![0;0m

set /a crateChance4=%random% %% 750
if %crateChance4% == 750 set /a legendaryCrate=%legendaryCrate%+1 & echo [0;33mYou mined 1 Legendary crate![0;0m

set /a oremined=%random% %% %maxMined%
if %oremined% LSS %minimumMined% set /a oremined = %oremined%+%minimumMined%
if %oremined% GTR %maxMined% set /a oremined = %maxMined%
set /a ore=%ore% + %oremined%
if %ore% GTR %maxBPSize% set /a ore=%maxBPSize%
echo You mined %oremined% %orename%
echo Now you have %ore% %orename%

set command=invalid
goto cmdselect


:upgradePick
if %pickaxe% == Netherite set /a upPickPrice=%tier10%
if %pickaxe% == Emerald set /a upPickPrice=%tier9%
if %pickaxe% == Diamond set /a upPickPrice=%tier8%
if %pickaxe% == Redstone set /a upPickPrice=%tier7%
if %pickaxe% == Golden set /a upPickPrice=%tier6%
if %pickaxe% == Quartz set /a upPickPrice=%tier5%
if %pickaxe% == Iron set /a upPickPrice=%tier4%
if %pickaxe% == Copper set /a upPickPrice=%tier3%
if %pickaxe% == Stone set /a upPickPrice=%tier2%
if %pickaxe% == Wooden set /a upPickPrice=%tier1%

if %pickaxe%== %maxPickaxe% goto maxLevelPick
if %money% LSS %upPickPrice% goto lowMoneyPick
set /a money=%money%-%upPickPrice% & set pickaxe=%nextPickaxe%
echo You successfully bought %nextpickaxe% pickaxe for %upPickPrice%^$.

goto cmdselect


:upgradeMinMined
if %minimumMined%== 15 goto maxLevelMinMined
if %token% LSS %upMinMinedPrice% goto lowTokenMMined
set /a token=%token%-%upMinMinedPrice% & set minimumMined=%nextMinMined%
echo You successfully upgraded "minimum mined" to level %nextMinMined%.
if %minimumMined% GTR 10 echo [0;94m[NOTE][0;0m Maximum mine limit for wooden pickaxe is 10[0;0m

goto cmdselect


:upgradeRebirthReward
if %rebirthReward%== 1 goto maxLevelRebirthReward
if %token% LSS %upRebirthRewardPrice% goto lowTokenRebirthReward
set /a token=%token%-%upRebirthRewardPrice% & set rebirthReward=%nextRebirthReward%
echo You successfully upgraded "Rebirth token reward" to level %nextRebirthReward%.

goto cmdselect


:upgradeAutosell
if %autosell%== 1 goto maxLevelAutosell
if %token% LSS %upAutosellPrice% goto lowTokenAutosell
set /a token=%token%-%upAutosellPrice% & set autosell=1
echo You successfully upgraded "Autosell" to level 1.

goto cmdselect


:upgradeSP
if %starterPack% == 2 goto maxLevelSP
if %token% LSS %upStarterPackPrice% goto lowTokenStarterPack
set /a token=%token%-%upStarterPackPrice% & set starterPack=%nextStarterPack%
echo You successfully upgraded "StarterPack" to level %nextStarterPack%.

goto cmdselect


:upgradeOre
if %orename% == %maxOre% goto maxLevelOre
if %token% LSS %upOrePrice% goto lowToken
set /a token=%token%-%upOrePrice% & set orename=%nextOre%
echo You successfully bought %nextore% ore for %upOrePrice% token(s).

goto cmdselect


:upgradeBP
if %backpack% == Netherite set /a upBPPrice=%tier10%
if %backpack% == Emerald set /a upBPPrice=%tier9%
if %backpack% == Diamond set /a upBPPrice=%tier8%
if %backpack% == Redstone set /a upBPPrice=%tier7%
if %backpack% == Golden set /a upBPPrice=%tier6%
if %backpack% == Quartz set /a upBPPrice=%tier5%
if %backpack% == Iron set /a upBPPrice=%tier4%
if %backpack% == Copper set /a upBPPrice=%tier3%
if %backpack% == Stone set /a upBPPrice=%tier2%
if %backpack% == Wooden set /a upBPPrice=%tier1%
if %backpack%== %maxBackpack% goto maxLevelBP

if %money% LSS %upBPPrice% goto lowMoneyBP
set /a money=%money%-%upBPPrice% & set backpack=%nextBP%
echo You successfully bought %nextbp% backpack for %upBPPrice%^$.
goto cmdselect


:shop
echo.
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
echo Stone tier = %tier1%^$
echo Copper tier = %tier2%^$
echo Iron tier = %tier3%^$
echo Quartz tier = %tier4%^$
echo Golden tier = %tier5%^$
echo Redstone tier = %tier6%^$
echo Diamond tier = %tier7%^$
echo Emerald tier = %tier8%^$
echo Netherite tier = %tier9%^$
echo Obsidian tier = %tier10%^$
echo.
echo Iron ore = 1 token
echo Copper ore = 2 token
echo Lapis ore = 3 tokens
echo Quartz ore = 4 tokens
echo Gold ore = 5 tokens
echo Redstone ore = 6 tokens
echo Diamond ore = 7 tokens
echo Emerald ore = 8 tokens
echo Netherite ore = 9 tokens
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
goto cmdselect


:stats
echo [0;94mPickaxe[0;0m: %pickaxe%
echo [0;94mBackpack[0;0m: %backpack%
echo [0;92mMoney[0;0m: %money%^$
echo [0;93mTokens[0;0m: %token%
echo Ore name: %oreName%
echo %orename% amount: %ore%
echo.
set /a totalCrates=%commonCrate%+%uncommonCrate%+%rareCrate%+%epicCrate%+%legendaryCrate%
echo Common crates: %commonCrate%
echo [0;92mUncommon crates[0;0m: %uncommonCrate%
echo [0;94mRare crates[0;0m: %rareCrate%
echo [0;35mEpic crates[0;0m: %epicCrate%
echo [0;33mLegendary crates[0;0m: %legendaryCrate%
echo Crates in total: %totalCrates%
goto cmdselect


:lowMoneyPick
set /a needMoreMoney=%upPickPrice%-%money%
echo [0;94m[Pickaxe][0;0m You don't have enough money!
echo [0;94m[Pickaxe][0;0m You need %needMoreMoney%^$ more for next upgrade!
goto cmdselect


:lowMoneyBP
set /a needMoreMoney=%upBPPrice%-%money%
echo [0;94m[Backpack][0;0m You don't have enough money!
echo [0;94m[Backpack][0;0m You need %needMoreMoney%^$ more for next upgrade!
goto cmdselect


:lowToken
set /a needMoreToken=%upOrePrice%-%token%
echo [0;94m[Ore][0;0m You don't have enough tokens!
echo [0;94m[Ore][0;0m You need %needMoreToken% token(s) more for next upgrade!
goto cmdselect


:lowTokenMMined
set /a needMoreToken=%upMinMinedPrice%-%token%
echo [0;94m[MinMined][0;0m You don't have enough tokens!
echo [0;94m[MinMined][0;0m You need %needMoreToken% token(s) more for next upgrade!
goto cmdselect

:lowTokenAutosell
set /a needMoreToken=%upAutosellPrice%-%token%
echo [0;94m[Autosell][0;0m You don't have enough tokens!
echo [0;94m[Autosell][0;0m You need %needMoreToken% token(s) more for next upgrade!
goto cmdselect

:lowTokenRebirthReward
set /a needMoreToken=%upMinMinedPrice%-%token%
echo [0;94m[RebirthReward][0;0m You don't have enough tokens!
echo [0;94m[RebirthReward][0;0m You need %needMoreToken% token(s) more for next upgrade!
goto cmdselect


:lowTokenStarterPack
set /a needMoreToken=%upStarterPackPrice%-%token%
echo [0;94m[StarterPack][0;0m You don't have enough tokens!
echo [0;94m[StarterPack][0;0m You need %needMoreToken% token(s) more for next upgrade!
goto cmdselect


:maxLevelPick
echo [0;94m[Pickaxe][0;0m You have reached the maximum level.
goto cmdselect


:maxLevelAutosell
echo [0;94m[Autosell skill][0;0m You have reached the maximum level.
goto cmdselect


:maxLevelMinMined
echo [0;94m[MinMined skill][0;0m You have reached the maximum level.
goto cmdselect


:maxLevelRebirthReward
echo [0;94m[RebirthReward skill][0;0m You have reached the maximum level.
goto cmdselect


:maxLevelBP
echo [0;94m[Backpack][0;0m You have reached the maximum level.
goto cmdselect


:maxLevelSP
echo [0;94m[StarterPack skill][0;0m You have reached the maximum level.
goto cmdselect


:maxLevelOre
echo [0;94m[Ore][0;0m You have reached the maximum level.
goto cmdselect


:maxBackpack
echo [0;91mYour backpack is full[0;0m
echo Use "sell" or "s" to free up space in your backpack.
goto cmdselect


:noOre
echo You don't have any %orename% that you can sell.
goto cmdselect


:oreInfo
echo.
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
echo Coal = 1x sell price
echo Iron = 1x sell price
echo Lapis = 2x sell price
echo Gold = 2x sell price
echo Redstone = 3x sell price
echo Diamond = 3x sell price
echo Emerald = 4x sell price
echo Netherite = 5x sell price
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
goto cmdselect


:help
echo [0;33m╔═══════════════════════════════════════════════════════════════╗
echo ║mine = Mine ores                                               ║
echo ║sell = Sell ores that you mined                                ║
echo ║stats = See your statistics                                    ║
echo ║upgrade pick = Upgrade your pickaxe                            ║
echo ║upgrade bp = Upgrade your backpack                             ║
echo ║upgrade ore = Upgrade your ore                                 ║
echo ║clear = Clear your screen                                      ║
echo ║reload = Reload Command Miner                                  ║
echo ║shop = Upgrade prices                                          ║
echo ║tokenshop = Place where you can spend your tokens              ║
echo ║save = Save your progress                                      ║
echo ║ore info = Info about ores                                     ║
echo ║crates = Shows how many crates you have                        ║
echo ║open ^<crate_tier^> = Open crate                                 ║
echo ║update = Update CM to latest version                           ║
echo ║set help = Settings                                            ║
echo ║accounts = Account manager                                     ║
echo ║mods = List of official mods                                   ║
echo ║dreward = Claim daily reward                                   ║
echo ║accs = Account manager                                         ║
echo ╚═══════════════════════════════════════════════════════════════╝[0;0m
echo [0;94m[NOTE][0;0m There is a lot of aliases like [0;93mo l[0;0m for [0;93mopen legendary[0;0m and many more!
echo [0;94m[NOTE][0;0m Use help ^<mod_name^> for mods help
goto cmdselect


:saveProgress
if %cheats%==true echo [0;91m[Error][0;0m You can't save your progress if you have used cheats & echo [0;91m[Error][0;0m Use "reload" or "rl" to load your last saved position & goto cmdselect
echo|set /p= Saving...
cd save
(
echo %backpack%
echo %pickaxe%
echo %money%
echo %ore%
echo %token%
echo %oreName%
echo %commonCrate%
echo %uncommonCrate%
echo %rareCrate%
echo %epicCrate%
echo %legendaryCrate%
echo %minimumMined%
echo %dimension%
echo %rebirthReward%
echo %autosell%
echo %rebirthCount%
echo %starterPack%
)>%account%.save
cd..
echo [0;32mDONE[0;0m
goto cmdselect


:balance
echo [0;92mMoney[0;0m: %money%^$
echo [0;93mTokens[0;0m: %token%
goto cmdselect


:rebirth
if not %pickaxe%==%maxPickaxe% goto rebirthFail
if not %backpack%==%maxBackpack% goto rebirthFail
set /a token=%token%+%tokenPlus%
set pickaxe=Wooden
set backpack=Wooden
if %starterPack% == 1 set pickaxe=Stone
if %starterPack% == 1 set backpack=Stone
if %starterPack% == 2 set pickaxe=Iron
if %starterPack% == 2 set backpack=Iron
set money=0
set ore=0
set commonCrate=0
set uncommonCrate=0
set rareCrate=0
set epicCrate=0
set legendaryCrate=0
set /a rebirthCount=%rebirthCount%+1
echo Rebirth was successful
echo You got %tokenPlus% token(s)
goto cmdselect


:rebirthFail
echo [0;91m[Error][0;0m You need to have %maxPickaxe% pickaxe and %maxBackpack% backpack!
echo [0;91m[Error][0;0m You only have %pickaxe% pickaxe and %backpack% backpack
goto cmdselect


:resetConfirm
echo Are you sure you want to start over? [Y/N]
set command=invalid
set /p resetNY=
if /i %resetNY%==y goto reset
if /i %resetNY%==n goto cmdselect
goto resetConfirm


:reset
set /a money=0
set /a token=0
set pickaxe=Wooden
set backpack=Wooden
set /a ore=0
set orename=Coal
set /a commonCrate=0
set /a uncommonCrate=0
set /a rareCrate=0
set /a epicCrate=0
set /a legendaryCrate=0
set /a minimumMined=0
set dimension=Overworld
set /a rebirthReward=0
set /a starterPack=0
set /a autosell=0
cls
echo Done, reset was successful
goto main


:openCrateCommon
if %command3%==all set command3=9999
set crateName=[0;0mCommon[0;0m
if %commonCrate%==0 goto noCrate
set /a randomMoney=%random% %% 200
if %randomMoney% GTR 150 set randomMoney=0
set /a commonCrate=%commonCrate%-1
if %randomMoney% GTR 0 echo You got %randomMoney%^$ from %crateName% crate
if %randomMoney%==0 echo [0;91mYou got %randomMoney%^$ from %crateName%[0;91m crate & echo Sorry but you get unlucky this time ^:^( [0;0m
set /a money=%money%+%randomMoney%
if %key%==cratesAll goto openCrateAll
if %command3% GTR 1 set /a command3=%command3%-1& goto openCrateCommon
goto cmdselect


:openCrateUncommon
if %command3%==all set command3=9999
set crateName=[0;92mUncommon[0;0m
if %uncommonCrate%==0 goto noCrate
set /a randomMoney=%random% %% 375
if %randomMoney% GTR 300 set randomMoney=0
set /a uncommonCrate=%uncommonCrate%-1
if %randomMoney% GTR 0 echo You got %randomMoney%^$ from %crateName% crate
if %randomMoney%==0 echo [0;91mYou got %randomMoney%^$ from %crateName%[0;91m crate & echo Sorry but you get unlucky this time ^:^( [0;0m
set /a money=%money%+%randomMoney%
if %key%==cratesAll goto openCrateAll
if %command3% GTR 1 set /a command3=%command3%-1& goto openCrateUncommon
goto cmdselect


:openCrateRare
if %command3%==all set command3=9999
set crateName=[0;94mRare[0;0m
if %rareCrate%==0 goto noCrate
set /a randomMoney=%random% %% 525
if %randomMoney% GTR 450 set randomMoney=0
if %randomMoney% LSS 50 set randomMoney=50
set /a rareCrate=%rareCrate%-1
echo You got %randomMoney%^$ from %crateName% crate
set /a money=%money%+%randomMoney%
if %key%==cratesAll goto openCrateAll
if %command3% GTR 1 set /a command3=%command3%-1& goto openCrateRare
goto cmdselect


:openCrateEpic
if %command3%==all set command3=9999
set crateName=[0;35mEpic[0;0m
if %epicCrate%==0 goto noCrate
set /a randomMoney=%random% %% 625
if %randomMoney% GTR 550 set randomMoney=0
if %randomMoney% LSS 100 set randomMoney=100
set /a epicCrate=%epicCrate%-1
echo You got %randomMoney%^$ from %crateName% crate
set /a money=%money%+%randomMoney%
if %key%==cratesAll goto openCrateAll
if %command3% GTR 1 set /a command3=%command3%-1& goto openCrateEpic
goto cmdselect


:openCrateLegendary
if %command3%==all set command3=9999
set crateName=[0;33mLegendary[0;0m
if %legendaryCrate%==0 goto noCrate
set /a randomMoney=%random% %% 925
if %randomMoney% GTR 900 set randomMoney=0
if %randomMoney% LSS 200 set randomMoney=200
set /a legendaryCrate=%legendaryCrate%-1
echo You got %randomMoney%^$ from %crateName% crate
set /a money=%money%+%randomMoney%
if %key%==cratesAll goto openCrateAll
if %command3% GTR 1 set /a command3=%command3%-1& goto openCrateLegendary
goto cmdselect


:openCrateAll
set key=cratesAll
if %commonCrate% GTR 0 goto openCrateCommon
if %uncommonCrate% GTR 0 goto openCrateUncommon
if %rareCrate% GTR 0 goto openCrateRare
if %epicCrate% GTR 0 goto openCrateEpic
if %legendaryCrate% GTR 0 goto openCrateLegendary
set key=0
goto cmdselect


:noCrate
set command3=0
echo [0;94m[Crates][0;0m You dont have any %crateName% crates!
goto cmdselect


:allCrates
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
echo Common:%commonCrate%
echo [0;92mUncommon[0;0m:%uncommonCrate%
echo [0;94mRare[0;0m:%rareCrate%
echo [0;35mEpic[0;0m:%epicCrate%
echo [0;33mLegendary[0;0m:%legendaryCrate%
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
goto cmdselect


:noPerms
echo [0;94m[Perms][0;0m You don't have permission for that command!
goto cmdselect


:update
if %internet%==none echo [0;91m[Error][0;0m No internet connection & goto cmdselect
echo Are you sure you want to download the latest version of Command Miner from 
echo https://fireroth.github.io/download/data/CommandMiner/latest?
echo [Y/N]
set /p UpdateConfirm=
if /i %UpdateConfirm%==y cd UpdateFiles & start /min Update.bat & exit
if /i %UpdateConfirm%==n goto cmdselect
goto update


:Mods
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
echo ExampleMod = Simple mod to understand how mods work
echo Blank = Mod template
echo ALLinONE = every version of CM in one
echo DebugUtilities = Well... debug utilities
echo RemoveUpdate = Removes the update feature
echo.
echo More mods coming soon!
echo [0;94m[NOTE][0;0m Use [0;93mmod install ^<mod_name^>[0;0m
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
goto cmdselect


:ModsCheck
if %internet%==none echo [0;91m[Error][0;0m No internet connection & goto cmdselect
cd %dataPath%\Mods
if /i %command3%==ExampleMod set modName=ExampleMod&goto ModDownload
if /i %command3%==Blank set modName=Blank&goto ModDownload
if /i %command3%==ALLinONE set modName=ALLinONE&goto ModDownload
if /i %command3%==DebugUtilities set modName=DebugUtilities&goto ModDownload
if /i %command3%==RemoveUpdate set modName=RemoveUpdate&goto ModDownload
cd %dataPath%
echo [0;31mPlease enter valid mod name![0;0m
goto cmdselect


:ModDownload
echo|set /p= [0;93m[Mods][0;0m Downloading...
curl --no-progress-meter https://fireroth.github.io/download/file/CommandMiner/mods8/%modName%.zip>%modName%.zip
echo DONE
echo|set /p= [0;93m[Mods][0;0m Extracting...
chcp 852>nul
powershell -Command Expand-Archive %modName%.zip -DestinationPath "%dataPath%\Mods" -Force
chcp 65001>nul
echo DONE
echo|set /p= [0;93m[Mods][0;0m Removing .zip file...
del %modName%.zip
if errorlevel 1 (echo [0;91m[Error][0;0m An unknown error has occurred!) else (echo DONE)
echo|set /p= [0;93m[Mods] Please restart Command Miner[0;0m
echo.
goto cmdselect


:tokenShop
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
echo [0;32m^|^|[0;0mMinimum mined
echo [0;32m^|^|[0;0mCurrent level: %minimumMined%
echo [0;32m^|^|[0;0mUpgrade price: %upMinMinedPrice%
echo [0;32m^|^|[0;0mUpgrade cmd: buy1
echo.
echo [0;36m^|^|[0;0mRebirth token reward
echo [0;36m^|^|[0;0mCurrent level: %rebirthReward%
echo [0;36m^|^|[0;0mUpgrade price: %upRebirthRewardPrice%
echo [0;36m^|^|[0;0mUpgrade cmd: buy2
echo.
echo [0;33m^|^|[0;0mAutosell
echo [0;33m^|^|[0;0mCurrent level: %autosell%
echo [0;33m^|^|[0;0mUpgrade price: %upAutosellPrice%
echo [0;33m^|^|[0;0mUpgrade cmd: buy3
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
echo TokenShop 1/2
goto cmdselect


:tokenShop2
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
echo [0;35m^|^|[0;0mStarter pack
echo [0;35m^|^|[0;0mCurrent level: %starterPack%
echo [0;35m^|^|[0;0mUpgrade price: %upStarterPackPrice%
echo [0;35m^|^|[0;0mUpgrade cmd: buy4
echo.
echo [0;31m^|^|[0;0mMore
echo [0;31m^|^|[0;0mComing
echo [0;31m^|^|[0;0mSoon
echo [0;31m^|^|[0;0m^;^)
echo [0;33m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0;0m 
echo TokenShop 2/2
goto cmdselect


:version 
echo Current version: %ver%
if %internet%==connected curl https://fireroth.github.io/download/data/CommandMiner/latestVer
goto cmdselect


:ACCS
title %account%
set ACCSOption2=%account%
cls
echo 				[1;36m--------------------------------------------[0;0m 
echo.
echo               				     Command Miner ACCS
echo.
echo 				[1;36m--------------------------------------------[0;0m 
echo delete ^<account_name^> = Remove account
echo enable = Enable accounts
echo disable = Disable accounts
echo exit
echo.
set /p ACCSOption=--^>
set count2=0
for %%a in (%ACCSOption%) do (
  set /a count2+=1
  set ACCSOption!count2!=%%a
)
if "%ACCSOption1%" == "exit" cls & cd.. & goto reload
if "%ACCSOption1%" == "delete" goto ACCSRemoveAcc
if "%ACCSOption1%" == "enable" set command3=true& set key=ACCService& goto setACC
if "%ACCSOption1%" == "disable" set command3=false& set key=ACCService& goto setACC
goto ACCS


:ACCSRemoveAcc
cd %dataPath%/Accounts
echo Are you sure you want to remove all account data and save file from the account %ACCSOption2%?
set /p ACCSDelPrompt=[Y/N]
if /i %ACCSDelPrompt%==y rmdir /S /Q %ACCSOption2% 2>nul & echo Removed %ACCSOption2% folder& cd %dataPath%/save & del %ACCSOption2%.save 2>nul & echo Removed %ACCSOption2%.save file & timeout 2 >nul & cd %dataPath% & cd %dataPath% & goto ACCS
if /i %ACCSDelPrompt%==n cd %dataPath% & goto ACCS

goto ACCSRemoveAcc


:claimDailyReward
cd Accounts\%account%
chcp 852>nul
for /f %%i in ('powershell ^(get-date^).DayOfWeek') do set day=%%i
chcp 65001>nul
if not exist nextDailyReward echo %day%>nextDailyReward

< nextDailyReward (
set /p nextReward=
)
if %day%==%nextReward% (goto dailyRewardPassed) else (echo [0;91m[Error][0;0m You already claimed your daily reward & goto cmdselect)


:dailyRewardPassed
if %day%==Monday set nextReward=Tuesday
if %day%==Tuesday set nextReward=Wednesday
if %day%==Wednesday set nextReward=Thursday
if %day%==Thursday set nextReward=Friday
if %day%==Friday set nextReward=Saturday
if %day%==Saturday set nextReward=Sunday
if %day%==Sunday set nextReward=Monday
echo [0;92mSuccesfully claimed daily reward, come back tomorrow for more![0;0m
set /a uncommonCrate=%uncommonCrate% +1 &echo You got 1 [0;92mUncommon[0;0m crate
set /a rareCrate=%rareCrate% +1 &echo You got 1 [0;94mRare[0;0m crate

echo %nextReward%>nextDailyReward
goto cmdselect


:Error0
cls
echo [0;91m[Error][0;31m An unexpected error has occurred!
echo [0;91m[Error][0;31m Operation was canceled[0;0m
goto main


:ErrorAdmin
echo [0;31mFAILED[0;0m
echo [0;91m[Error][0;31m Administrator mode is not supported!
echo [0;91m[Error][0;31m Command Miner cannot be loaded
pause>nul
exit


:ErrorVariables
cls
echo [0;91m[Error][0;31m An unexpected error has occurred!
echo [0;91m[Error][0;31m Something is wrong with your save file
echo [0;91m[Error][0;31m Try removing it in Command_Miner_Data ^> Save ^> %account%.save
echo [0;94m[NOTE][0;31m Downloading previously installed mods can help to resolve this issue[0;0m
pause>nul
cls & goto ErrorVariables


:ErrorMod
cls
echo [0;91m[Error][0;31m A handled exception has occurred
echo [0;91m[Error][0;31m Loaded mods are missing some important files[0;0m
pause>nul
cls & cd.. & cd.. & cd.. & goto reload

:ErrorFile
echo off
cls
echo [0;91m[Error][0;31m An unexpected error has occurred!
echo [0;91m[Error][0;31m Restarting Command Miner can help[0;0m
pause>nul
exit
